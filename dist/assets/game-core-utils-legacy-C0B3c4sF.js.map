{"version":3,"file":"game-core-utils-legacy-C0B3c4sF.js","sources":["../../src/core/EventBus.js","../../src/core/PerformanceMonitor.js","../../src/core/InputManager.js"],"sourcesContent":["/**\n * EventBus.js - Central event management system\n *\n * This class provides:\n * - Event emission and listening\n * - Event filtering and transformation\n * - Event history and debugging\n * - Performance monitoring\n */\n\nexport class EventBus {\n  constructor() {\n    this.listeners = new Map();\n    this.eventHistory = [];\n    this.maxHistorySize = 1000;\n    this.debug = false;\n    this.performanceMetrics = {\n      totalEvents: 0,\n      averageProcessingTime: 0,\n      slowestEvent: null,\n      eventCounts: new Map(),\n    };\n  }\n\n  /**\n   * Add event listener\n   */\n  on(event, callback, options = {}) {\n    if (typeof callback !== 'function') {\n      throw new Error('Callback must be a function');\n    }\n\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, []);\n    }\n\n    const listener = {\n      callback,\n      once: options.once || false,\n      priority: options.priority || 0,\n      id: options.id || null,\n      context: options.context || null,\n    };\n\n    this.listeners.get(event).push(listener);\n\n    // Sort by priority (higher priority first)\n    this.listeners.get(event).sort((a, b) => b.priority - a.priority);\n\n    this.log(`Added listener for event: ${event}`);\n  }\n\n  /**\n   * Add one-time event listener\n   */\n  once(event, callback, options = {}) {\n    this.on(event, callback, { ...options, once: true });\n  }\n\n  /**\n   * Remove event listener\n   */\n  off(event, callback) {\n    if (!this.listeners.has(event)) {\n      return;\n    }\n\n    const eventListeners = this.listeners.get(event);\n    const index = eventListeners.findIndex(\n      (listener) => listener.callback === callback\n    );\n\n    if (index !== -1) {\n      eventListeners.splice(index, 1);\n      this.log(`Removed listener for event: ${event}`);\n    }\n  }\n\n  /**\n   * Remove all listeners for an event\n   */\n  removeAllListeners(event) {\n    if (event) {\n      this.listeners.delete(event);\n      this.log(`Removed all listeners for event: ${event}`);\n    } else {\n      this.listeners.clear();\n      this.log('Removed all listeners');\n    }\n  }\n\n  /**\n   * Alias for off method for backward compatibility\n   */\n  removeListener(event, callback) {\n    return this.off(event, callback);\n  }\n\n  /**\n   * Emit an event\n   */\n  emit(event, data = {}) {\n    const startTime = performance.now();\n\n    if (!this.listeners.has(event)) {\n      this.log(`No listeners for event: ${event}`);\n      return;\n    }\n\n    const eventListeners = this.listeners.get(event);\n    const eventData = {\n      event,\n      data,\n      timestamp: Date.now(),\n      id: this.generateEventId(),\n    };\n\n    // Add to history\n    this.addToHistory(eventData);\n\n    // Update performance metrics\n    this.updatePerformanceMetrics(event, startTime);\n\n    // Call listeners\n    const listenersToRemove = [];\n\n    for (let i = 0; i < eventListeners.length; i++) {\n      const listener = eventListeners[i];\n\n      try {\n        // Call listener with context if provided\n        if (listener.context) {\n          listener.callback.call(listener.context, eventData.data, eventData);\n        } else {\n          listener.callback(eventData.data, eventData);\n        }\n\n        // Mark for removal if it's a one-time listener\n        if (listener.once) {\n          listenersToRemove.push(i);\n        }\n      } catch (error) {\n        console.error(`Error in event listener for ${event}:`, error);\n      }\n    }\n\n    // Remove one-time listeners\n    for (let i = listenersToRemove.length - 1; i >= 0; i--) {\n      eventListeners.splice(listenersToRemove[i], 1);\n    }\n\n    this.log(`Emitted event: ${event}`, eventData);\n  }\n\n  /**\n   * Emit event asynchronously\n   */\n  async emitAsync(event, data = {}) {\n    return new Promise((resolve, reject) => {\n      try {\n        this.emit(event, data);\n        resolve();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Wait for an event\n   */\n  waitFor(event, timeout = 5000) {\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        this.off(event, handler);\n        reject(new Error(`Timeout waiting for event: ${event}`));\n      }, timeout);\n\n      const handler = (data, eventData) => {\n        clearTimeout(timeoutId);\n        this.off(event, handler);\n        resolve({ data, eventData });\n      };\n\n      this.on(event, handler);\n    });\n  }\n\n  /**\n   * Add event to history\n   */\n  addToHistory(eventData) {\n    this.eventHistory.push(eventData);\n\n    // Maintain history size limit\n    if (this.eventHistory.length > this.maxHistorySize) {\n      this.eventHistory.shift();\n    }\n  }\n\n  /**\n   * Update performance metrics\n   */\n  updatePerformanceMetrics(event, startTime) {\n    const processingTime = performance.now() - startTime;\n\n    this.performanceMetrics.totalEvents++;\n\n    // Update average processing time\n    const totalTime =\n      this.performanceMetrics.averageProcessingTime *\n      (this.performanceMetrics.totalEvents - 1);\n    this.performanceMetrics.averageProcessingTime =\n      (totalTime + processingTime) / this.performanceMetrics.totalEvents;\n\n    // Update slowest event\n    if (\n      !this.performanceMetrics.slowestEvent ||\n      processingTime > this.performanceMetrics.slowestEvent.time\n    ) {\n      this.performanceMetrics.slowestEvent = {\n        event,\n        time: processingTime,\n        timestamp: Date.now(),\n      };\n    }\n\n    // Update event counts\n    const count = this.performanceMetrics.eventCounts.get(event) || 0;\n    this.performanceMetrics.eventCounts.set(event, count + 1);\n  }\n\n  /**\n   * Generate unique event ID\n   */\n  generateEventId() {\n    return `event_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Get event history\n   */\n  getHistory(filter = {}) {\n    let history = [...this.eventHistory];\n\n    if (filter.event) {\n      history = history.filter((item) => item.event === filter.event);\n    }\n\n    if (filter.since) {\n      history = history.filter((item) => item.timestamp >= filter.since);\n    }\n\n    if (filter.until) {\n      history = history.filter((item) => item.timestamp <= filter.until);\n    }\n\n    if (filter.limit) {\n      history = history.slice(-filter.limit);\n    }\n\n    return history;\n  }\n\n  /**\n   * Get performance metrics\n   */\n  getPerformanceMetrics() {\n    return {\n      ...this.performanceMetrics,\n      eventCounts: Object.fromEntries(this.performanceMetrics.eventCounts),\n    };\n  }\n\n  /**\n   * Clear event history\n   */\n  clearHistory() {\n    this.eventHistory = [];\n    this.log('Event history cleared');\n  }\n\n  /**\n   * Reset performance metrics\n   */\n  resetMetrics() {\n    this.performanceMetrics = {\n      totalEvents: 0,\n      averageProcessingTime: 0,\n      slowestEvent: null,\n      eventCounts: new Map(),\n    };\n    this.log('Performance metrics reset');\n  }\n\n  /**\n   * Enable debug mode\n   */\n  enableDebug() {\n    this.debug = true;\n    this.log('Debug mode enabled');\n  }\n\n  /**\n   * Disable debug mode\n   */\n  disableDebug() {\n    this.debug = false;\n  }\n\n  /**\n   * Log debug message\n   */\n  log(message, data = null) {\n    if (this.debug) {\n      if (data) {\n        console.log(`[EventBus] ${message}`, data);\n      } else {\n        console.log(`[EventBus] ${message}`);\n      }\n    }\n  }\n\n  /**\n   * Get listener count for an event\n   */\n  getListenerCount(event) {\n    return this.listeners.has(event) ? this.listeners.get(event).length : 0;\n  }\n\n  /**\n   * Get all registered events\n   */\n  getRegisteredEvents() {\n    return Array.from(this.listeners.keys());\n  }\n\n  /**\n   * Check if event has listeners\n   */\n  hasListeners(event) {\n    return this.listeners.has(event) && this.listeners.get(event).length > 0;\n  }\n\n  /**\n   * Create event filter\n   */\n  createFilter(event, condition) {\n    return (data, eventData) => {\n      if (condition(data, eventData)) {\n        this.emit(event, data);\n      }\n    };\n  }\n\n  /**\n   * Create event transformer\n   */\n  createTransformer(event, transform) {\n    return (data, eventData) => {\n      const transformedData = transform(data, eventData);\n      this.emit(event, transformedData);\n    };\n  }\n\n  /**\n   * Destroy the event bus\n   */\n  destroy() {\n    this.listeners.clear();\n    this.eventHistory = [];\n    this.performanceMetrics = {\n      totalEvents: 0,\n      averageProcessingTime: 0,\n      slowestEvent: null,\n      eventCounts: new Map(),\n    };\n    this.log('EventBus destroyed');\n  }\n}\n\nexport default EventBus;\n","/**\n * PerformanceMonitor.js - Comprehensive performance monitoring and optimization system\n *\n * This monitor handles:\n * - FPS monitoring and frame time analysis\n * - Memory usage tracking and leak detection\n * - Audio context performance monitoring\n * - Rendering performance analysis\n * - Input lag measurement\n * - Network performance tracking\n * - Performance bottleneck identification\n * - Automatic optimization suggestions\n */\n\nexport class PerformanceMonitor {\n  constructor(dependencies = {}) {\n    // Dependency injection\n    this.eventBus = dependencies.eventBus;\n    this.logger = dependencies.logger;\n    this.config = dependencies.config;\n\n    // Validate required dependencies\n    if (!this.eventBus) {\n      throw new Error('PerformanceMonitor requires eventBus dependency');\n    }\n    if (!this.logger) {\n      throw new Error('PerformanceMonitor requires logger dependency');\n    }\n\n    // Performance configuration\n    this.config = {\n      enableFPSMonitoring: true,\n      enableMemoryMonitoring: true,\n      enableAudioMonitoring: true,\n      enableRenderingMonitoring: true,\n      enableInputMonitoring: true,\n      enableNetworkMonitoring: true,\n      enableAutoOptimization: true,\n      fpsTarget: 60,\n      fpsWarningThreshold: 45,\n      fpsCriticalThreshold: 30,\n      memoryWarningThreshold: 100 * 1024 * 1024, // 100MB\n      memoryCriticalThreshold: 200 * 1024 * 1024, // 200MB\n      frameTimeWarningThreshold: 16.67, // 60fps = 16.67ms per frame\n      frameTimeCriticalThreshold: 33.33, // 30fps = 33.33ms per frame\n      reportInterval: 5000, // Report every 5 seconds\n      maxHistorySize: 1000,\n      ...dependencies.config,\n    };\n\n    // Performance metrics\n    this.metrics = {\n      fps: {\n        current: 0,\n        average: 0,\n        min: Infinity,\n        max: 0,\n        history: [],\n        droppedFrames: 0,\n      },\n      frameTime: {\n        current: 0,\n        average: 0,\n        min: Infinity,\n        max: 0,\n        history: [],\n      },\n      memory: {\n        used: 0,\n        total: 0,\n        available: 0,\n        history: [],\n        leakDetected: false,\n        leakCount: 0,\n      },\n      audio: {\n        contextState: 'suspended',\n        contextRecreations: 0,\n        bufferUnderruns: 0,\n        latency: 0,\n        performanceScore: 0,\n      },\n      rendering: {\n        drawCalls: 0,\n        triangles: 0,\n        textures: 0,\n        shaders: 0,\n        batchCount: 0,\n        cullingTime: 0,\n        lightingTime: 0,\n        postProcessingTime: 0,\n      },\n      input: {\n        lag: 0,\n        eventCount: 0,\n        droppedEvents: 0,\n        averageResponseTime: 0,\n      },\n      network: {\n        latency: 0,\n        bandwidth: 0,\n        packetLoss: 0,\n        connectionQuality: 'good',\n      },\n    };\n\n    // Performance state\n    this.isMonitoring = false;\n    this.lastFrameTime = 0;\n    this.frameCount = 0;\n    this.lastReportTime = 0;\n    this.optimizationSuggestions = [];\n    this.performanceAlerts = [];\n\n    // Performance observers\n    this.observers = {\n      fps: null,\n      memory: null,\n      audio: null,\n      rendering: null,\n      input: null,\n      network: null,\n    };\n\n    // Set up performance monitoring\n    this.setupPerformanceMonitoring();\n    this.setupEventHandlers();\n\n    this.logger.info('PerformanceMonitor initialized');\n  }\n\n  /**\n   * Initialize the monitor\n   */\n  async initialize() {\n    this.logger.info('Initializing PerformanceMonitor...');\n\n    // Start monitoring if enabled\n    if (this.config.enableFPSMonitoring || this.config.enableMemoryMonitoring) {\n      this.startMonitoring();\n    }\n\n    this.logger.info('PerformanceMonitor initialized successfully');\n  }\n\n  /**\n   * Cleanup the monitor\n   */\n  cleanup() {\n    this.logger.info('Cleaning up PerformanceMonitor...');\n\n    // Stop monitoring\n    this.stopMonitoring();\n\n    // Disconnect observers\n    this.disconnectObservers();\n\n    this.logger.info('PerformanceMonitor cleaned up');\n  }\n\n  /**\n   * Set up performance monitoring\n   */\n  setupPerformanceMonitoring() {\n    // Set up FPS monitoring\n    if (this.config.enableFPSMonitoring) {\n      this.setupFPSMonitoring();\n    }\n\n    // Set up memory monitoring\n    if (this.config.enableMemoryMonitoring) {\n      this.setupMemoryMonitoring();\n    }\n\n    // Set up audio monitoring\n    if (this.config.enableAudioMonitoring) {\n      this.setupAudioMonitoring();\n    }\n\n    // Set up rendering monitoring\n    if (this.config.enableRenderingMonitoring) {\n      this.setupRenderingMonitoring();\n    }\n\n    // Set up input monitoring\n    if (this.config.enableInputMonitoring) {\n      this.setupInputMonitoring();\n    }\n\n    // Set up network monitoring\n    if (this.config.enableNetworkMonitoring) {\n      this.setupNetworkMonitoring();\n    }\n  }\n\n  /**\n   * Set up event handlers\n   */\n  setupEventHandlers() {\n    // Game events\n    this.eventBus.on('game:started', this.handleGameStarted.bind(this));\n    this.eventBus.on('game:paused', this.handleGamePaused.bind(this));\n    this.eventBus.on('game:resumed', this.handleGameResumed.bind(this));\n    this.eventBus.on('game:stopped', this.handleGameStopped.bind(this));\n\n    // Performance events\n    this.eventBus.on('performance:frame', this.handleFrame.bind(this));\n    this.eventBus.on('performance:memory', this.handleMemoryUpdate.bind(this));\n    this.eventBus.on('performance:audio', this.handleAudioUpdate.bind(this));\n    this.eventBus.on('performance:rendering', this.handleRenderingUpdate.bind(this));\n    this.eventBus.on('performance:input', this.handleInputUpdate.bind(this));\n    this.eventBus.on('performance:network', this.handleNetworkUpdate.bind(this));\n  }\n\n  /**\n   * Set up FPS monitoring\n   */\n  setupFPSMonitoring() {\n    this.lastFrameTime = performance.now();\n    this.frameCount = 0;\n\n    const measureFPS = (currentTime) => {\n      if (!this.isMonitoring) return;\n\n      const deltaTime = currentTime - this.lastFrameTime;\n      this.lastFrameTime = currentTime;\n\n      // Calculate FPS\n      const fps = 1000 / deltaTime;\n      this.updateFPSMetrics(fps, deltaTime);\n\n      // Continue monitoring\n      requestAnimationFrame(measureFPS);\n    };\n\n    this.observers.fps = measureFPS;\n  }\n\n  /**\n   * Set up memory monitoring\n   */\n  setupMemoryMonitoring() {\n    if (!performance.memory) {\n      this.logger.warn('Performance.memory API not available');\n      return;\n    }\n\n    const measureMemory = () => {\n      if (!this.isMonitoring) return;\n\n      const memory = performance.memory;\n      this.updateMemoryMetrics(memory);\n\n      // Check for memory leaks\n      this.detectMemoryLeaks();\n\n      // Continue monitoring\n      setTimeout(measureMemory, 1000);\n    };\n\n    this.observers.memory = measureMemory;\n  }\n\n  /**\n   * Set up audio monitoring\n   */\n  setupAudioMonitoring() {\n    // Monitor audio context state\n    const measureAudio = () => {\n      if (!this.isMonitoring) return;\n\n      // Check for audio context recreations\n      this.checkAudioContextHealth();\n\n      // Continue monitoring\n      setTimeout(measureAudio, 2000);\n    };\n\n    this.observers.audio = measureAudio;\n  }\n\n  /**\n   * Set up rendering monitoring\n   */\n  setupRenderingMonitoring() {\n    // This would integrate with the rendering system\n    // For now, we'll set up basic monitoring\n    const measureRendering = () => {\n      if (!this.isMonitoring) return;\n\n      // Monitor rendering performance\n      this.updateRenderingMetrics();\n\n      // Continue monitoring\n      requestAnimationFrame(measureRendering);\n    };\n\n    this.observers.rendering = measureRendering;\n  }\n\n  /**\n   * Set up input monitoring\n   */\n  setupInputMonitoring() {\n    let inputEventCount = 0;\n    let lastInputTime = 0;\n\n    const measureInput = (event) => {\n      if (!this.isMonitoring) return;\n\n      const currentTime = performance.now();\n      const responseTime = currentTime - lastInputTime;\n\n      inputEventCount++;\n      this.updateInputMetrics(responseTime);\n\n      lastInputTime = currentTime;\n    };\n\n    // Listen for input events\n    document.addEventListener('keydown', measureInput);\n    document.addEventListener('mousedown', measureInput);\n    document.addEventListener('touchstart', measureInput);\n\n    this.observers.input = measureInput;\n  }\n\n  /**\n   * Set up network monitoring\n   */\n  setupNetworkMonitoring() {\n    const measureNetwork = () => {\n      if (!this.isMonitoring) return;\n\n      // Monitor network performance\n      this.updateNetworkMetrics();\n\n      // Continue monitoring\n      setTimeout(measureNetwork, 5000);\n    };\n\n    this.observers.network = measureNetwork;\n  }\n\n  /**\n   * Start monitoring\n   */\n  startMonitoring() {\n    if (this.isMonitoring) return;\n\n    this.isMonitoring = true;\n    this.lastReportTime = performance.now();\n\n    // Start FPS monitoring\n    if (this.observers.fps) {\n      requestAnimationFrame(this.observers.fps);\n    }\n\n    // Start other monitoring\n    if (this.observers.memory) {\n      this.observers.memory();\n    }\n    if (this.observers.audio) {\n      this.observers.audio();\n    }\n    if (this.observers.rendering) {\n      requestAnimationFrame(this.observers.rendering);\n    }\n    if (this.observers.network) {\n      this.observers.network();\n    }\n\n    this.logger.info('Performance monitoring started');\n  }\n\n  /**\n   * Stop monitoring\n   */\n  stopMonitoring() {\n    if (!this.isMonitoring) return;\n\n    this.isMonitoring = false;\n\n    this.logger.info('Performance monitoring stopped');\n  }\n\n  /**\n   * Disconnect observers\n   */\n  disconnectObservers() {\n    // Remove input event listeners\n    if (this.observers.input) {\n      document.removeEventListener('keydown', this.observers.input);\n      document.removeEventListener('mousedown', this.observers.input);\n      document.removeEventListener('touchstart', this.observers.input);\n    }\n  }\n\n  /**\n   * Update FPS metrics\n   */\n  updateFPSMetrics(fps, frameTime) {\n    this.metrics.fps.current = fps;\n    this.metrics.fps.history.push(fps);\n    this.metrics.fps.min = Math.min(this.metrics.fps.min, fps);\n    this.metrics.fps.max = Math.max(this.metrics.fps.max, fps);\n\n    // Calculate average FPS\n    if (this.metrics.fps.history.length > 0) {\n      this.metrics.fps.average = this.metrics.fps.history.reduce((a, b) => a + b, 0) / this.metrics.fps.history.length;\n    }\n\n    // Update frame time metrics\n    this.metrics.frameTime.current = frameTime;\n    this.metrics.frameTime.history.push(frameTime);\n    this.metrics.frameTime.min = Math.min(this.metrics.frameTime.min, frameTime);\n    this.metrics.frameTime.max = Math.max(this.metrics.frameTime.max, frameTime);\n\n    if (this.metrics.frameTime.history.length > 0) {\n      this.metrics.frameTime.average = this.metrics.frameTime.history.reduce((a, b) => a + b, 0) / this.metrics.frameTime.history.length;\n    }\n\n    // Check for dropped frames\n    if (frameTime > this.config.frameTimeCriticalThreshold) {\n      this.metrics.fps.droppedFrames++;\n    }\n\n    // Maintain history size\n    if (this.metrics.fps.history.length > this.config.maxHistorySize) {\n      this.metrics.fps.history.shift();\n      this.metrics.frameTime.history.shift();\n    }\n\n    // Check for performance issues\n    this.checkFPSPerformance();\n  }\n\n  /**\n   * Update memory metrics\n   */\n  updateMemoryMetrics(memory) {\n    this.metrics.memory.used = memory.usedJSHeapSize;\n    this.metrics.memory.total = memory.totalJSHeapSize;\n    this.metrics.memory.available = memory.jsHeapSizeLimit - memory.usedJSHeapSize;\n\n    this.metrics.memory.history.push({\n      used: memory.usedJSHeapSize,\n      total: memory.totalJSHeapSize,\n      timestamp: performance.now(),\n    });\n\n    // Maintain history size\n    if (this.metrics.memory.history.length > this.config.maxHistorySize) {\n      this.metrics.memory.history.shift();\n    }\n\n    // Check for memory issues\n    this.checkMemoryPerformance();\n  }\n\n  /**\n   * Update audio metrics\n   */\n  updateAudioMetrics(audioData) {\n    this.metrics.audio = { ...this.metrics.audio, ...audioData };\n\n    // Check for audio performance issues\n    this.checkAudioPerformance();\n  }\n\n  /**\n   * Update rendering metrics\n   */\n  updateRenderingMetrics() {\n    // This would be populated by the rendering system\n    // For now, we'll use placeholder values\n    this.metrics.rendering.drawCalls = 0;\n    this.metrics.rendering.triangles = 0;\n    this.metrics.rendering.textures = 0;\n    this.metrics.rendering.shaders = 0;\n  }\n\n  /**\n   * Update input metrics\n   */\n  updateInputMetrics(responseTime) {\n    this.metrics.input.eventCount++;\n    this.metrics.input.lag = responseTime;\n\n    // Calculate average response time\n    if (this.metrics.input.eventCount > 0) {\n      this.metrics.input.averageResponseTime = \n        (this.metrics.input.averageResponseTime * (this.metrics.input.eventCount - 1) + responseTime) / this.metrics.input.eventCount;\n    }\n\n    // Check for input performance issues\n    this.checkInputPerformance();\n  }\n\n  /**\n   * Update network metrics\n   */\n  updateNetworkMetrics() {\n    // This would integrate with network monitoring\n    // For now, we'll use placeholder values\n    this.metrics.network.latency = 0;\n    this.metrics.network.bandwidth = 0;\n    this.metrics.network.packetLoss = 0;\n    this.metrics.network.connectionQuality = 'good';\n  }\n\n  /**\n   * Check FPS performance\n   */\n  checkFPSPerformance() {\n    const fps = this.metrics.fps.current;\n    const frameTime = this.metrics.frameTime.current;\n\n    if (fps < this.config.fpsCriticalThreshold) {\n      this.addPerformanceAlert('critical', 'FPS critically low', { fps, threshold: this.config.fpsCriticalThreshold });\n      this.suggestOptimization('fps', 'Consider reducing graphics quality or disabling non-essential features');\n    } else if (fps < this.config.fpsWarningThreshold) {\n      this.addPerformanceAlert('warning', 'FPS below target', { fps, threshold: this.config.fpsWarningThreshold });\n    }\n\n    if (frameTime > this.config.frameTimeCriticalThreshold) {\n      this.addPerformanceAlert('critical', 'Frame time too high', { frameTime, threshold: this.config.frameTimeCriticalThreshold });\n    } else if (frameTime > this.config.frameTimeWarningThreshold) {\n      this.addPerformanceAlert('warning', 'Frame time above target', { frameTime, threshold: this.config.frameTimeWarningThreshold });\n    }\n  }\n\n  /**\n   * Check memory performance\n   */\n  checkMemoryPerformance() {\n    const used = this.metrics.memory.used;\n\n    if (used > this.config.memoryCriticalThreshold) {\n      this.addPerformanceAlert('critical', 'Memory usage critically high', { used, threshold: this.config.memoryCriticalThreshold });\n      this.suggestOptimization('memory', 'Consider reducing texture quality or clearing unused assets');\n    } else if (used > this.config.memoryWarningThreshold) {\n      this.addPerformanceAlert('warning', 'Memory usage high', { used, threshold: this.config.memoryWarningThreshold });\n    }\n  }\n\n  /**\n   * Check audio performance\n   */\n  checkAudioPerformance() {\n    if (this.metrics.audio.contextRecreations > 5) {\n      this.addPerformanceAlert('warning', 'Audio context recreated multiple times', { recreations: this.metrics.audio.contextRecreations });\n      this.suggestOptimization('audio', 'Consider implementing audio context pooling or lazy initialization');\n    }\n\n    if (this.metrics.audio.bufferUnderruns > 10) {\n      this.addPerformanceAlert('warning', 'Audio buffer underruns detected', { underruns: this.metrics.audio.bufferUnderruns });\n    }\n  }\n\n  /**\n   * Check input performance\n   */\n  checkInputPerformance() {\n    const lag = this.metrics.input.lag;\n\n    if (lag > 100) {\n      this.addPerformanceAlert('warning', 'Input lag detected', { lag });\n      this.suggestOptimization('input', 'Consider optimizing input handling or reducing input processing overhead');\n    }\n  }\n\n  /**\n   * Detect memory leaks\n   */\n  detectMemoryLeaks() {\n    const history = this.metrics.memory.history;\n    if (history.length < 10) return;\n\n    // Check if memory usage is consistently increasing\n    const recent = history.slice(-10);\n    const isIncreasing = recent.every((entry, index) => {\n      if (index === 0) return true;\n      return entry.used > recent[index - 1].used;\n    });\n\n    if (isIncreasing) {\n      this.metrics.memory.leakDetected = true;\n      this.metrics.memory.leakCount++;\n      this.addPerformanceAlert('warning', 'Potential memory leak detected', { leakCount: this.metrics.memory.leakCount });\n      this.suggestOptimization('memory', 'Check for circular references or unremoved event listeners');\n    }\n  }\n\n  /**\n   * Check audio context health\n   */\n  checkAudioContextHealth() {\n    // This would check the actual audio context state\n    // For now, we'll simulate the check\n    const contextState = 'running'; // This would be the actual context state\n\n    if (contextState !== this.metrics.audio.contextState) {\n      if (this.metrics.audio.contextState === 'suspended' && contextState === 'running') {\n        this.metrics.audio.contextRecreations++;\n        this.addPerformanceAlert('info', 'Audio context recreated', { recreations: this.metrics.audio.contextRecreations });\n      }\n      this.metrics.audio.contextState = contextState;\n    }\n  }\n\n  /**\n   * Add performance alert\n   */\n  addPerformanceAlert(level, message, data) {\n    const alert = {\n      level,\n      message,\n      data,\n      timestamp: performance.now(),\n    };\n\n    this.performanceAlerts.push(alert);\n\n    // Emit alert event\n    this.eventBus.emit('performance:alert', alert);\n\n    // Log alert\n    switch (level) {\n      case 'critical':\n        this.logger.error(`Performance Alert: ${message}`, data);\n        break;\n      case 'warning':\n        this.logger.warn(`Performance Alert: ${message}`, data);\n        break;\n      case 'info':\n        this.logger.info(`Performance Alert: ${message}`, data);\n        break;\n    }\n  }\n\n  /**\n   * Suggest optimization\n   */\n  suggestOptimization(category, suggestion) {\n    const optimization = {\n      category,\n      suggestion,\n      timestamp: performance.now(),\n    };\n\n    this.optimizationSuggestions.push(optimization);\n\n    // Emit optimization event\n    this.eventBus.emit('performance:optimization', optimization);\n\n    this.logger.info(`Performance Optimization: ${suggestion}`);\n  }\n\n  /**\n   * Get performance report\n   */\n  getPerformanceReport() {\n    return {\n      metrics: this.metrics,\n      alerts: this.performanceAlerts,\n      suggestions: this.optimizationSuggestions,\n      timestamp: performance.now(),\n    };\n  }\n\n  /**\n   * Get performance score\n   */\n  getPerformanceScore() {\n    let score = 100;\n\n    // FPS score\n    const fps = this.metrics.fps.current;\n    if (fps < this.config.fpsCriticalThreshold) {\n      score -= 40;\n    } else if (fps < this.config.fpsWarningThreshold) {\n      score -= 20;\n    }\n\n    // Memory score\n    const memoryUsage = this.metrics.memory.used / this.metrics.memory.total;\n    if (memoryUsage > 0.9) {\n      score -= 30;\n    } else if (memoryUsage > 0.7) {\n      score -= 15;\n    }\n\n    // Frame time score\n    const frameTime = this.metrics.frameTime.current;\n    if (frameTime > this.config.frameTimeCriticalThreshold) {\n      score -= 20;\n    } else if (frameTime > this.config.frameTimeWarningThreshold) {\n      score -= 10;\n    }\n\n    return Math.max(0, Math.min(100, score));\n  }\n\n  /**\n   * Handle game started\n   */\n  handleGameStarted(data) {\n    this.startMonitoring();\n  }\n\n  /**\n   * Handle game paused\n   */\n  handleGamePaused(data) {\n    // Continue monitoring but reduce frequency\n  }\n\n  /**\n   * Handle game resumed\n   */\n  handleGameResumed(data) {\n    // Resume normal monitoring\n  }\n\n  /**\n   * Handle game stopped\n   */\n  handleGameStopped(data) {\n    this.stopMonitoring();\n  }\n\n  /**\n   * Handle frame event\n   */\n  handleFrame(data) {\n    // This would be called by the rendering system\n  }\n\n  /**\n   * Handle memory update\n   */\n  handleMemoryUpdate(data) {\n    this.updateMemoryMetrics(data);\n  }\n\n  /**\n   * Handle audio update\n   */\n  handleAudioUpdate(data) {\n    this.updateAudioMetrics(data);\n  }\n\n  /**\n   * Handle rendering update\n   */\n  handleRenderingUpdate(data) {\n    this.metrics.rendering = { ...this.metrics.rendering, ...data };\n  }\n\n  /**\n   * Handle input update\n   */\n  handleInputUpdate(data) {\n    this.updateInputMetrics(data.responseTime);\n  }\n\n  /**\n   * Handle network update\n   */\n  handleNetworkUpdate(data) {\n    this.metrics.network = { ...this.metrics.network, ...data };\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(newConfig) {\n    this.config = { ...this.config, ...newConfig };\n  }\n\n  /**\n   * Get current metrics\n   */\n  getMetrics() {\n    return this.metrics;\n  }\n\n  /**\n   * Get alerts\n   */\n  getAlerts() {\n    return this.performanceAlerts;\n  }\n\n  /**\n   * Get optimization suggestions\n   */\n  getOptimizationSuggestions() {\n    return this.optimizationSuggestions;\n  }\n\n  /**\n   * Clear alerts\n   */\n  clearAlerts() {\n    this.performanceAlerts = [];\n  }\n\n  /**\n   * Clear optimization suggestions\n   */\n  clearOptimizationSuggestions() {\n    this.optimizationSuggestions = [];\n  }\n}\n\nexport default PerformanceMonitor;","/**\n * InputManager.js - Comprehensive input handling with accessibility support\n *\n * This manager handles:\n * - Keyboard input with accessibility support\n * - Mouse input and touch events\n * - Gamepad support\n * - Input mapping and customization\n * - Accessibility features (keyboard navigation, focus management)\n * - Input event normalization\n */\n\nexport class InputManager {\n  constructor(dependencies = {}) {\n    // Dependency injection\n    this.eventBus = dependencies.eventBus;\n    this.logger = dependencies.logger;\n    this.config = dependencies.config;\n\n    // Validate required dependencies\n    if (!this.eventBus) {\n      throw new Error('InputManager requires eventBus dependency');\n    }\n    if (!this.logger) {\n      throw new Error('InputManager requires logger dependency');\n    }\n\n    // Input state\n    this.keys = new Map();\n    this.mouse = {\n      x: 0,\n      y: 0,\n      buttons: new Map(),\n      wheel: 0,\n    };\n    this.touch = {\n      touches: new Map(),\n      gestures: new Map(),\n      activeGestures: new Map(),\n      lastTapTime: 0,\n      lastTapPosition: { x: 0, y: 0 },\n      longPressTimer: null,\n      doubleTapTimer: null,\n    };\n\n    // Mobile UI state\n    this.mobileUI = {\n      virtualJoystick: {\n        active: false,\n        center: { x: 0, y: 0 },\n        position: { x: 0, y: 0 },\n        radius: 60,\n        touchId: null,\n      },\n      actionButtons: new Map(),\n      isVisible: false,\n      orientation: 'portrait',\n    };\n    this.gamepad = {\n      controllers: new Map(),\n      lastUpdate: 0,\n    };\n\n    // Input mapping\n    this.keyMappings = new Map();\n    this.mouseMappings = new Map();\n    this.gamepadMappings = new Map();\n    this.touchMappings = new Map();\n\n    // Accessibility features\n    this.accessibility = {\n      keyboardNavigation: false,\n      focusManagement: true,\n      tabOrder: [],\n      currentFocusIndex: 0,\n      focusableElements: new Set(),\n      skipLinks: new Map(),\n    };\n\n    // Input configuration\n    this.settings = {\n      mouseSensitivity: 1.0,\n      keyboardLayout: 'qwerty',\n      enableMouseLook: true,\n      enableKeyboardNavigation: true,\n      enableGamepad: true,\n      enableTouch: true,\n      invertY: false,\n      deadzone: 0.1,\n      repeatDelay: 500,\n      repeatRate: 50,\n      // Mobile-specific settings\n      mobileControls: {\n        enabled: true,\n        layout: 'default', // 'default', 'compact', 'custom'\n        size: 'medium', // 'small', 'medium', 'large'\n        opacity: 0.8,\n        position: 'bottom', // 'bottom', 'top', 'left', 'right', 'custom'\n        showLabels: true,\n        hapticFeedback: true,\n        gestureSensitivity: 1.0,\n        touchDeadzone: 0.05,\n        multiTouch: true,\n        pinchToZoom: true,\n        swipeThreshold: 50,\n        longPressDelay: 500,\n        doubleTapDelay: 300,\n      },\n      // Touch gesture settings\n      gestures: {\n        enableSwipe: true,\n        enablePinch: true,\n        enableRotate: true,\n        enableLongPress: true,\n        enableDoubleTap: true,\n        swipeDirections: ['up', 'down', 'left', 'right'],\n        pinchThreshold: 0.1,\n        rotateThreshold: 5, // degrees\n      },\n      // Mobile UI controls\n      mobileUI: {\n        showVirtualJoystick: true,\n        showActionButtons: true,\n        showMenuButton: true,\n        showPauseButton: true,\n        buttonSpacing: 10,\n        buttonSize: 60,\n        joystickSize: 120,\n        joystickDeadzone: 0.1,\n        buttonOpacity: 0.8,\n        buttonPressScale: 0.9,\n        enableButtonHaptics: true,\n      },\n    };\n\n    // Event handling\n    this.boundHandlers = new Map();\n    this.isEnabled = true;\n    this.isCaptured = false;\n\n    // Initialize input system\n    this.initializeInputMappings();\n    this.setupEventHandlers();\n    this.setupAccessibility();\n    this.setupMobileControls();\n\n    this.logger.info('InputManager initialized');\n  }\n\n  /**\n   * Initialize the manager\n   */\n  async initialize() {\n    this.logger.info('Initializing InputManager...');\n\n    // Load input settings from config\n    if (this.config) {\n      this.loadSettingsFromConfig();\n    }\n\n    // Set up focus management\n    this.setupFocusManagement();\n\n    this.logger.info('InputManager initialized successfully');\n  }\n\n  /**\n   * Cleanup the manager\n   */\n  cleanup() {\n    this.logger.info('Cleaning up InputManager...');\n\n    // Remove event listeners\n    this.removeEventHandlers();\n\n    // Clear state\n    this.keys.clear();\n    this.mouse.buttons.clear();\n    this.touch.touches.clear();\n    this.gamepad.controllers.clear();\n\n    this.logger.info('InputManager cleaned up');\n  }\n\n  /**\n   * Update the manager\n   */\n  update(deltaTime) {\n    if (!this.isEnabled) return;\n\n    // Update gamepad state\n    this.updateGamepadState();\n\n    // Update accessibility features\n    this.updateAccessibilityFeatures();\n\n    // Process input events\n    this.processInputEvents();\n  }\n\n  /**\n   * Initialize input mappings\n   */\n  initializeInputMappings() {\n    // Keyboard mappings\n    this.keyMappings.set('moveUp', ['KeyW', 'ArrowUp']);\n    this.keyMappings.set('moveDown', ['KeyS', 'ArrowDown']);\n    this.keyMappings.set('moveLeft', ['KeyA', 'ArrowLeft']);\n    this.keyMappings.set('moveRight', ['KeyD', 'ArrowRight']);\n    this.keyMappings.set('jump', ['Space']);\n    this.keyMappings.set('crouch', ['KeyC', 'ShiftLeft']);\n    this.keyMappings.set('run', ['ShiftLeft']);\n    this.keyMappings.set('interact', ['KeyE', 'Enter']);\n    this.keyMappings.set('pause', ['Escape', 'KeyP']);\n    this.keyMappings.set('inventory', ['KeyI', 'Tab']);\n    this.keyMappings.set('menu', ['Escape', 'KeyM']);\n    this.keyMappings.set('confirm', ['Enter', 'Space']);\n    this.keyMappings.set('cancel', ['Escape', 'Backspace']);\n    this.keyMappings.set('next', ['Tab', 'ArrowDown']);\n    this.keyMappings.set('previous', ['ShiftLeft+Tab', 'ArrowUp']);\n\n    // Mouse mappings\n    this.mouseMappings.set('leftClick', 0);\n    this.mouseMappings.set('rightClick', 2);\n    this.mouseMappings.set('middleClick', 1);\n    this.mouseMappings.set('scrollUp', 'wheelUp');\n    this.mouseMappings.set('scrollDown', 'wheelDown');\n\n    // Gamepad mappings\n    this.gamepadMappings.set('moveUp', 'dpadUp');\n    this.gamepadMappings.set('moveDown', 'dpadDown');\n    this.gamepadMappings.set('moveLeft', 'dpadLeft');\n    this.gamepadMappings.set('moveRight', 'dpadRight');\n    this.gamepadMappings.set('jump', 'buttonA');\n    this.gamepadMappings.set('interact', 'buttonX');\n    this.gamepadMappings.set('pause', 'buttonStart');\n    this.gamepadMappings.set('menu', 'buttonSelect');\n    this.gamepadMappings.set('confirm', 'buttonA');\n    this.gamepadMappings.set('cancel', 'buttonB');\n\n    // Touch mappings\n    this.touchMappings.set('tap', 'tap');\n    this.touchMappings.set('doubleTap', 'doubleTap');\n    this.touchMappings.set('longPress', 'longPress');\n    this.touchMappings.set('swipe', 'swipe');\n    this.touchMappings.set('pinch', 'pinch');\n    this.touchMappings.set('rotate', 'rotate');\n  }\n\n  /**\n   * Set up event handlers\n   */\n  setupEventHandlers() {\n    // Keyboard events\n    this.boundHandlers.set('keydown', this.handleKeyDown.bind(this));\n    this.boundHandlers.set('keyup', this.handleKeyUp.bind(this));\n    this.boundHandlers.set('keypress', this.handleKeyPress.bind(this));\n\n    // Mouse events\n    this.boundHandlers.set('mousedown', this.handleMouseDown.bind(this));\n    this.boundHandlers.set('mouseup', this.handleMouseUp.bind(this));\n    this.boundHandlers.set('mousemove', this.handleMouseMove.bind(this));\n    this.boundHandlers.set('wheel', this.handleWheel.bind(this));\n    this.boundHandlers.set('contextmenu', this.handleContextMenu.bind(this));\n\n    // Touch events\n    this.boundHandlers.set('touchstart', this.handleTouchStart.bind(this));\n    this.boundHandlers.set('touchend', this.handleTouchEnd.bind(this));\n    this.boundHandlers.set('touchmove', this.handleTouchMove.bind(this));\n    this.boundHandlers.set('touchcancel', this.handleTouchCancel.bind(this));\n\n    // Gamepad events\n    this.boundHandlers.set(\n      'gamepadconnected',\n      this.handleGamepadConnected.bind(this)\n    );\n    this.boundHandlers.set(\n      'gamepaddisconnected',\n      this.handleGamepadDisconnected.bind(this)\n    );\n\n    // Focus events\n    this.boundHandlers.set('focusin', this.handleFocusIn.bind(this));\n    this.boundHandlers.set('focusout', this.handleFocusOut.bind(this));\n\n    // Add event listeners\n    this.addEventListeners();\n  }\n\n  /**\n   * Add event listeners\n   */\n  addEventListeners() {\n    for (const [event, handler] of this.boundHandlers) {\n      document.addEventListener(event, handler, { passive: false });\n    }\n  }\n\n  /**\n   * Remove event handlers\n   */\n  removeEventHandlers() {\n    for (const [event, handler] of this.boundHandlers) {\n      document.removeEventListener(event, handler);\n    }\n    this.boundHandlers.clear();\n  }\n\n  /**\n   * Set up accessibility features\n   */\n  setupAccessibility() {\n    // Set up keyboard navigation\n    if (this.settings.enableKeyboardNavigation) {\n      this.accessibility.keyboardNavigation = true;\n    }\n\n    // Set up focus management\n    this.setupFocusManagement();\n  }\n\n  /**\n   * Set up focus management\n   */\n  setupFocusManagement() {\n    // Find all focusable elements\n    this.updateFocusableElements();\n\n    // Set up tab order\n    this.updateTabOrder();\n\n    // Set up skip links\n    this.setupSkipLinks();\n  }\n\n  /**\n   * Update focusable elements\n   */\n  updateFocusableElements() {\n    this.accessibility.focusableElements.clear();\n\n    const focusableSelectors = [\n      'button:not([disabled])',\n      'input:not([disabled])',\n      'select:not([disabled])',\n      'textarea:not([disabled])',\n      'a[href]',\n      '[tabindex]:not([tabindex=\"-1\"])',\n      '[role=\"button\"]:not([disabled])',\n      '[role=\"link\"]',\n      '[role=\"menuitem\"]',\n      '[role=\"tab\"]',\n      '[role=\"option\"]',\n    ];\n\n    const elements = document.querySelectorAll(focusableSelectors.join(', '));\n    elements.forEach((element) => {\n      this.accessibility.focusableElements.add(element);\n    });\n  }\n\n  /**\n   * Update tab order\n   */\n  updateTabOrder() {\n    this.accessibility.tabOrder = Array.from(\n      this.accessibility.focusableElements\n    ).sort((a, b) => {\n      const aTabIndex = parseInt(a.getAttribute('tabindex') || '0');\n      const bTabIndex = parseInt(b.getAttribute('tabindex') || '0');\n      return aTabIndex - bTabIndex;\n    });\n  }\n\n  /**\n   * Set up skip links\n   */\n  setupSkipLinks() {\n    // Create skip links for accessibility\n    const skipLinks = [\n      { id: 'skip-main', text: 'Skip to main content', target: 'main' },\n      { id: 'skip-nav', text: 'Skip to navigation', target: 'nav' },\n      { id: 'skip-content', text: 'Skip to content', target: 'content' },\n    ];\n\n    skipLinks.forEach((link) => {\n      this.accessibility.skipLinks.set(link.id, link);\n    });\n  }\n\n  /**\n   * Set up mobile controls\n   */\n  setupMobileControls() {\n    if (!this.settings.enableTouch || !this.settings.mobileControls.enabled) {\n      return;\n    }\n\n    // Skip mobile controls setup in test environments\n    if (typeof window !== 'undefined' && window.navigator && window.navigator.userAgent.includes('jsdom')) {\n      this.logger.info('Skipping mobile controls setup in test environment');\n      return;\n    }\n\n    // Detect mobile device\n    this.detectMobileDevice();\n\n    // Create mobile UI elements\n    this.createMobileUI();\n\n    // Set up orientation handling\n    this.setupOrientationHandling();\n\n    // Set up gesture recognition\n    this.setupGestureRecognition();\n\n    this.logger.info('Mobile controls initialized');\n  }\n\n  /**\n   * Detect mobile device\n   */\n  detectMobileDevice() {\n    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n    const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n    \n    this.isMobile = isMobile || isTouch;\n    \n    if (this.isMobile) {\n      this.logger.info('Mobile device detected');\n    }\n  }\n\n  /**\n   * Create mobile UI elements\n   */\n  createMobileUI() {\n    if (!this.isMobile) return;\n\n    // Create mobile controls container\n    this.mobileControlsContainer = document.createElement('div');\n    this.mobileControlsContainer.id = 'mobile-controls';\n    this.mobileControlsContainer.className = 'mobile-controls';\n    this.mobileControlsContainer.style.cssText = `\n      position: fixed;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      height: 200px;\n      pointer-events: none;\n      z-index: 1000;\n      display: ${this.settings.mobileControls.enabled ? 'block' : 'none'};\n    `;\n    \n    // Ensure the element is properly initialized\n    if (!this.mobileControlsContainer.nodeType) {\n      this.mobileControlsContainer = null;\n      return;\n    }\n\n    // Create virtual joystick\n    if (this.settings.mobileUI.showVirtualJoystick) {\n      this.createVirtualJoystick();\n    }\n\n    // Create action buttons\n    if (this.settings.mobileUI.showActionButtons) {\n      this.createActionButtons();\n    }\n\n    // Create menu button\n    if (this.settings.mobileUI.showMenuButton) {\n      this.createMenuButton();\n    }\n\n    // Create pause button\n    if (this.settings.mobileUI.showPauseButton) {\n      this.createPauseButton();\n    }\n\n    if (document.body) {\n      document.body.appendChild(this.mobileControlsContainer);\n    }\n  }\n\n  /**\n   * Create virtual joystick\n   */\n  createVirtualJoystick() {\n    const joystickContainer = document.createElement('div');\n    joystickContainer.className = 'virtual-joystick';\n    joystickContainer.style.cssText = `\n      position: absolute;\n      left: 20px;\n      bottom: 20px;\n      width: ${this.settings.mobileUI.joystickSize}px;\n      height: ${this.settings.mobileUI.joystickSize}px;\n      pointer-events: auto;\n    `;\n\n    const joystickBase = document.createElement('div');\n    joystickBase.className = 'joystick-base';\n    joystickBase.style.cssText = `\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n      background: rgba(255, 255, 255, ${this.settings.mobileUI.buttonOpacity});\n      border: 2px solid rgba(0, 0, 0, 0.3);\n      position: relative;\n    `;\n\n    const joystickKnob = document.createElement('div');\n    joystickKnob.className = 'joystick-knob';\n    joystickKnob.style.cssText = `\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      width: 40px;\n      height: 40px;\n      border-radius: 50%;\n      background: rgba(0, 0, 0, 0.5);\n      transform: translate(-50%, -50%);\n      transition: transform 0.1s ease;\n    `;\n\n    joystickBase.appendChild(joystickKnob);\n    joystickContainer.appendChild(joystickBase);\n    if (this.mobileControlsContainer) {\n      this.mobileControlsContainer.appendChild(joystickContainer);\n    }\n\n    // Store references\n    this.mobileUI.virtualJoystick.element = joystickContainer;\n    this.mobileUI.virtualJoystick.base = joystickBase;\n    this.mobileUI.virtualJoystick.knob = joystickKnob;\n    this.mobileUI.virtualJoystick.center = {\n      x: this.settings.mobileUI.joystickSize / 2,\n      y: this.settings.mobileUI.joystickSize / 2,\n    };\n  }\n\n  /**\n   * Create action buttons\n   */\n  createActionButtons() {\n    const buttonContainer = document.createElement('div');\n    buttonContainer.className = 'action-buttons';\n    buttonContainer.style.cssText = `\n      position: absolute;\n      right: 20px;\n      bottom: 20px;\n      display: flex;\n      flex-direction: column;\n      gap: ${this.settings.mobileUI.buttonSpacing}px;\n      pointer-events: auto;\n    `;\n\n    const buttons = [\n      { id: 'jump', label: 'Jump', key: 'Space' },\n      { id: 'interact', label: 'Interact', key: 'KeyE' },\n      { id: 'crouch', label: 'Crouch', key: 'KeyC' },\n      { id: 'run', label: 'Run', key: 'ShiftLeft' },\n    ];\n\n    buttons.forEach((button) => {\n      const buttonElement = document.createElement('button');\n      buttonElement.className = `action-button ${button.id}`;\n      buttonElement.textContent = this.settings.mobileControls.showLabels ? button.label : '';\n      buttonElement.style.cssText = `\n        width: ${this.settings.mobileUI.buttonSize}px;\n        height: ${this.settings.mobileUI.buttonSize}px;\n        border-radius: 50%;\n        background: rgba(255, 255, 255, ${this.settings.mobileUI.buttonOpacity});\n        border: 2px solid rgba(0, 0, 0, 0.3);\n        color: #000;\n        font-size: 12px;\n        font-weight: bold;\n        cursor: pointer;\n        user-select: none;\n        transition: transform 0.1s ease;\n      `;\n\n      // Add touch event handlers\n      buttonElement.addEventListener('touchstart', (e) => {\n        e.preventDefault();\n        this.handleMobileButtonPress(button.id, button.key, 'down');\n        buttonElement.style.transform = `scale(${this.settings.mobileUI.buttonPressScale})`;\n      });\n\n      buttonElement.addEventListener('touchend', (e) => {\n        e.preventDefault();\n        this.handleMobileButtonPress(button.id, button.key, 'up');\n        buttonElement.style.transform = 'scale(1)';\n      });\n\n      buttonContainer.appendChild(buttonElement);\n      this.mobileUI.actionButtons.set(button.id, buttonElement);\n    });\n\n    if (this.mobileControlsContainer) {\n      this.mobileControlsContainer.appendChild(buttonContainer);\n    }\n  }\n\n  /**\n   * Create menu button\n   */\n  createMenuButton() {\n    const menuButton = document.createElement('button');\n    menuButton.className = 'menu-button';\n    menuButton.innerHTML = '☰';\n    menuButton.style.cssText = `\n      position: absolute;\n      top: 20px;\n      right: 20px;\n      width: ${this.settings.mobileUI.buttonSize}px;\n      height: ${this.settings.mobileUI.buttonSize}px;\n      border-radius: 50%;\n      background: rgba(255, 255, 255, ${this.settings.mobileUI.buttonOpacity});\n      border: 2px solid rgba(0, 0, 0, 0.3);\n      color: #000;\n      font-size: 20px;\n      cursor: pointer;\n      pointer-events: auto;\n      user-select: none;\n    `;\n\n    menuButton.addEventListener('touchstart', (e) => {\n      e.preventDefault();\n      this.handleMobileButtonPress('menu', 'KeyM', 'down');\n    });\n\n    if (this.mobileControlsContainer) {\n      this.mobileControlsContainer.appendChild(menuButton);\n    }\n  }\n\n  /**\n   * Create pause button\n   */\n  createPauseButton() {\n    const pauseButton = document.createElement('button');\n    pauseButton.className = 'pause-button';\n    pauseButton.innerHTML = '⏸';\n    pauseButton.style.cssText = `\n      position: absolute;\n      top: 20px;\n      left: 20px;\n      width: ${this.settings.mobileUI.buttonSize}px;\n      height: ${this.settings.mobileUI.buttonSize}px;\n      border-radius: 50%;\n      background: rgba(255, 255, 255, ${this.settings.mobileUI.buttonOpacity});\n      border: 2px solid rgba(0, 0, 0, 0.3);\n      color: #000;\n      font-size: 20px;\n      cursor: pointer;\n      pointer-events: auto;\n      user-select: none;\n    `;\n\n    pauseButton.addEventListener('touchstart', (e) => {\n      e.preventDefault();\n      this.handleMobileButtonPress('pause', 'Escape', 'down');\n    });\n\n    if (this.mobileControlsContainer) {\n      this.mobileControlsContainer.appendChild(pauseButton);\n    }\n  }\n\n  /**\n   * Set up orientation handling\n   */\n  setupOrientationHandling() {\n    const updateOrientation = () => {\n      const isPortrait = window.innerHeight > window.innerWidth;\n      this.mobileUI.orientation = isPortrait ? 'portrait' : 'landscape';\n      \n      // Adjust mobile controls for orientation\n      this.adjustMobileControlsForOrientation();\n    };\n\n    window.addEventListener('orientationchange', updateOrientation);\n    window.addEventListener('resize', updateOrientation);\n    updateOrientation();\n  }\n\n  /**\n   * Adjust mobile controls for orientation\n   */\n  adjustMobileControlsForOrientation() {\n    if (!this.mobileControlsContainer) return;\n\n    if (this.mobileUI.orientation === 'landscape') {\n      // Adjust for landscape mode\n      this.mobileControlsContainer.style.height = '150px';\n    } else {\n      // Adjust for portrait mode\n      this.mobileControlsContainer.style.height = '200px';\n    }\n  }\n\n  /**\n   * Set up gesture recognition\n   */\n  setupGestureRecognition() {\n    if (!this.settings.gestures.enableSwipe && \n        !this.settings.gestures.enablePinch && \n        !this.settings.gestures.enableRotate) {\n      return;\n    }\n\n    // This would integrate with a gesture recognition library\n    // For now, we'll implement basic gesture detection\n    this.setupBasicGestureDetection();\n  }\n\n  /**\n   * Set up basic gesture detection\n   */\n  setupBasicGestureDetection() {\n    let startTouches = [];\n    let startDistance = 0;\n    let startAngle = 0;\n\n    const handleTouchStart = (e) => {\n      startTouches = Array.from(e.touches);\n      if (startTouches.length === 2) {\n        startDistance = this.getDistance(startTouches[0], startTouches[1]);\n        startAngle = this.getAngle(startTouches[0], startTouches[1]);\n      }\n    };\n\n    const handleTouchMove = (e) => {\n      if (e.touches.length === 2 && this.settings.gestures.enablePinch) {\n        const currentDistance = this.getDistance(e.touches[0], e.touches[1]);\n        const scale = currentDistance / startDistance;\n        \n        if (Math.abs(scale - 1) > this.settings.gestures.pinchThreshold) {\n          this.handlePinchGesture(scale);\n        }\n      }\n\n      if (e.touches.length === 2 && this.settings.gestures.enableRotate) {\n        const currentAngle = this.getAngle(e.touches[0], e.touches[1]);\n        const rotation = currentAngle - startAngle;\n        \n        if (Math.abs(rotation) > this.settings.gestures.rotateThreshold) {\n          this.handleRotateGesture(rotation);\n        }\n      }\n    };\n\n    const handleTouchEnd = (e) => {\n      if (e.touches.length === 0 && startTouches.length === 1) {\n        // Single touch ended - check for swipe\n        this.checkForSwipe(startTouches[0], e.changedTouches[0]);\n      }\n    };\n\n    document.addEventListener('touchstart', handleTouchStart, { passive: true });\n    document.addEventListener('touchmove', handleTouchMove, { passive: true });\n    document.addEventListener('touchend', handleTouchEnd, { passive: true });\n  }\n\n  /**\n   * Handle keyboard down events\n   */\n  handleKeyDown(event) {\n    if (!this.isEnabled) return;\n\n    const key = event.code;\n    const keyName = this.getKeyName(key);\n\n    // Update key state\n    this.keys.set(key, {\n      pressed: true,\n      timestamp: Date.now(),\n      repeat: this.keys.has(key),\n    });\n\n    // Handle accessibility features\n    if (this.accessibility.keyboardNavigation) {\n      this.handleAccessibilityKeyDown(event);\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:keyDown', {\n      key,\n      keyName,\n      code: event.code,\n      keyCode: event.keyCode,\n      repeat: this.keys.get(key).repeat,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n\n    // Handle mapped actions\n    this.handleMappedAction('keyboard', key, 'down', event);\n  }\n\n  /**\n   * Handle keyboard up events\n   */\n  handleKeyUp(event) {\n    if (!this.isEnabled) return;\n\n    const key = event.code;\n    const keyName = this.getKeyName(key);\n\n    // Update key state\n    this.keys.set(key, {\n      pressed: false,\n      timestamp: Date.now(),\n      repeat: false,\n    });\n\n    // Emit input event\n    this.eventBus.emit('input:keyUp', {\n      key,\n      keyName,\n      code: event.code,\n      keyCode: event.keyCode,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n\n    // Handle mapped actions\n    this.handleMappedAction('keyboard', key, 'up', event);\n  }\n\n  /**\n   * Handle keyboard press events\n   */\n  handleKeyPress(event) {\n    if (!this.isEnabled) return;\n\n    const key = event.key;\n    const charCode = event.charCode;\n\n    // Emit input event\n    this.eventBus.emit('input:keyPress', {\n      key,\n      charCode,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle mouse down events\n   */\n  handleMouseDown(event) {\n    if (!this.isEnabled) return;\n\n    const button = event.button;\n    const buttonName = this.getMouseButtonName(button);\n\n    // Update mouse state\n    this.mouse.buttons.set(button, {\n      pressed: true,\n      timestamp: Date.now(),\n    });\n\n    // Update mouse position\n    this.mouse.x = event.clientX;\n    this.mouse.y = event.clientY;\n\n    // Emit input event\n    this.eventBus.emit('input:mouseDown', {\n      button,\n      buttonName,\n      x: event.clientX,\n      y: event.clientY,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n\n    // Handle mapped actions\n    this.handleMappedAction('mouse', button, 'down', event);\n  }\n\n  /**\n   * Handle mouse up events\n   */\n  handleMouseUp(event) {\n    if (!this.isEnabled) return;\n\n    const button = event.button;\n    const buttonName = this.getMouseButtonName(button);\n\n    // Update mouse state\n    this.mouse.buttons.set(button, {\n      pressed: false,\n      timestamp: Date.now(),\n    });\n\n    // Update mouse position\n    this.mouse.x = event.clientX;\n    this.mouse.y = event.clientY;\n\n    // Emit input event\n    this.eventBus.emit('input:mouseUp', {\n      button,\n      buttonName,\n      x: event.clientX,\n      y: event.clientY,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n\n    // Handle mapped actions\n    this.handleMappedAction('mouse', button, 'up', event);\n  }\n\n  /**\n   * Handle mouse move events\n   */\n  handleMouseMove(event) {\n    if (!this.isEnabled) return;\n\n    // Update mouse position\n    const deltaX = event.clientX - this.mouse.x;\n    const deltaY = event.clientY - this.mouse.y;\n\n    this.mouse.x = event.clientX;\n    this.mouse.y = event.clientY;\n\n    // Apply sensitivity\n    const sensitivity = this.settings.mouseSensitivity;\n    const adjustedDeltaX = deltaX * sensitivity;\n    const adjustedDeltaY = this.settings.invertY\n      ? -deltaY * sensitivity\n      : deltaY * sensitivity;\n\n    // Emit input event\n    this.eventBus.emit('input:mouseMove', {\n      x: event.clientX,\n      y: event.clientY,\n      deltaX: adjustedDeltaX,\n      deltaY: adjustedDeltaY,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle wheel events\n   */\n  handleWheel(event) {\n    if (!this.isEnabled) return;\n\n    const deltaY = event.deltaY;\n    const direction = deltaY > 0 ? 'down' : 'up';\n\n    this.mouse.wheel = deltaY;\n\n    // Emit input event\n    this.eventBus.emit('input:wheel', {\n      deltaY,\n      direction,\n      x: event.clientX,\n      y: event.clientY,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey,\n      altKey: event.altKey,\n      metaKey: event.metaKey,\n      timestamp: Date.now(),\n    });\n\n    // Handle mapped actions\n    this.handleMappedAction('mouse', direction, 'wheel', event);\n  }\n\n  /**\n   * Handle context menu events\n   */\n  handleContextMenu(event) {\n    if (!this.isEnabled) return;\n\n    // Prevent context menu if needed\n    if (this.isCaptured) {\n      event.preventDefault();\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:contextMenu', {\n      x: event.clientX,\n      y: event.clientY,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle touch start events\n   */\n  handleTouchStart(event) {\n    if (!this.isEnabled || !this.settings.enableTouch) return;\n\n    // Prevent default to avoid mouse events\n    event.preventDefault();\n\n    // Update touch state\n    for (const touch of event.changedTouches) {\n      this.touch.touches.set(touch.identifier, {\n        x: touch.clientX,\n        y: touch.clientY,\n        startX: touch.clientX,\n        startY: touch.clientY,\n        startTime: Date.now(),\n        pressure: touch.force || 1.0,\n      });\n\n      // Handle mobile-specific touch events\n      if (this.isMobile) {\n        this.handleMobileTouchStart(touch, event);\n      }\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:touchStart', {\n      touches: Array.from(event.changedTouches).map((touch) => ({\n        id: touch.identifier,\n        x: touch.clientX,\n        y: touch.clientY,\n        pressure: touch.force || 1.0,\n      })),\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle touch end events\n   */\n  handleTouchEnd(event) {\n    if (!this.isEnabled || !this.settings.enableTouch) return;\n\n    // Prevent default\n    event.preventDefault();\n\n    // Update touch state\n    for (const touch of event.changedTouches) {\n      // Handle mobile-specific touch events\n      if (this.isMobile) {\n        this.handleMobileTouchEnd(touch, event);\n      }\n\n      this.touch.touches.delete(touch.identifier);\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:touchEnd', {\n      touches: Array.from(event.changedTouches).map((touch) => ({\n        id: touch.identifier,\n        x: touch.clientX,\n        y: touch.clientY,\n      })),\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle touch move events\n   */\n  handleTouchMove(event) {\n    if (!this.isEnabled || !this.settings.enableTouch) return;\n\n    // Prevent default to avoid scrolling\n    event.preventDefault();\n\n    // Update touch state\n    for (const touch of event.changedTouches) {\n      if (this.touch.touches.has(touch.identifier)) {\n        const touchData = this.touch.touches.get(touch.identifier);\n        touchData.x = touch.clientX;\n        touchData.y = touch.clientY;\n\n        // Handle mobile-specific touch events\n        if (this.isMobile) {\n          this.handleMobileTouchMove(touch, event);\n        }\n      }\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:touchMove', {\n      touches: Array.from(event.changedTouches).map((touch) => ({\n        id: touch.identifier,\n        x: touch.clientX,\n        y: touch.clientY,\n        pressure: touch.force || 1.0,\n      })),\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle touch cancel events\n   */\n  handleTouchCancel(event) {\n    if (!this.isEnabled || !this.settings.enableTouch) return;\n\n    // Update touch state\n    for (const touch of event.changedTouches) {\n      this.touch.touches.delete(touch.identifier);\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:touchCancel', {\n      touches: Array.from(event.changedTouches).map((touch) => ({\n        id: touch.identifier,\n        x: touch.clientX,\n        y: touch.clientY,\n      })),\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle gamepad connected events\n   */\n  handleGamepadConnected(event) {\n    if (!this.settings.enableGamepad) return;\n\n    const gamepad = event.gamepad;\n    this.gamepad.controllers.set(gamepad.index, {\n      id: gamepad.id,\n      index: gamepad.index,\n      connected: true,\n      buttons: new Map(),\n      axes: new Map(),\n    });\n\n    this.logger.info(`Gamepad connected: ${gamepad.id}`);\n\n    // Emit input event\n    this.eventBus.emit('input:gamepadConnected', {\n      id: gamepad.id,\n      index: gamepad.index,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle gamepad disconnected events\n   */\n  handleGamepadDisconnected(event) {\n    const gamepad = event.gamepad;\n    this.gamepad.controllers.delete(gamepad.index);\n\n    this.logger.info(`Gamepad disconnected: ${gamepad.id}`);\n\n    // Emit input event\n    this.eventBus.emit('input:gamepadDisconnected', {\n      id: gamepad.id,\n      index: gamepad.index,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle focus in events\n   */\n  handleFocusIn(event) {\n    if (!this.accessibility.focusManagement) return;\n\n    const element = event.target;\n    const index = this.accessibility.tabOrder.indexOf(element);\n\n    if (index !== -1) {\n      this.accessibility.currentFocusIndex = index;\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:focusIn', {\n      element,\n      index,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle focus out events\n   */\n  handleFocusOut(event) {\n    if (!this.accessibility.focusManagement) return;\n\n    const element = event.target;\n\n    // Emit input event\n    this.eventBus.emit('input:focusOut', {\n      element,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle accessibility key down events\n   */\n  handleAccessibilityKeyDown(event) {\n    const key = event.key;\n\n    switch (key) {\n      case 'Tab':\n        this.handleTabNavigation(event);\n        break;\n      case 'Enter':\n      case ' ':\n        this.handleActivation(event);\n        break;\n      case 'Escape':\n        this.handleEscape(event);\n        break;\n      case 'ArrowUp':\n      case 'ArrowDown':\n      case 'ArrowLeft':\n      case 'ArrowRight':\n        this.handleArrowNavigation(event);\n        break;\n    }\n  }\n\n  /**\n   * Handle tab navigation\n   */\n  handleTabNavigation(event) {\n    if (this.accessibility.tabOrder.length === 0) return;\n\n    const direction = event.shiftKey ? -1 : 1;\n    const newIndex =\n      (this.accessibility.currentFocusIndex +\n        direction +\n        this.accessibility.tabOrder.length) %\n      this.accessibility.tabOrder.length;\n\n    const nextElement = this.accessibility.tabOrder[newIndex];\n    if (nextElement) {\n      nextElement.focus();\n      this.accessibility.currentFocusIndex = newIndex;\n    }\n  }\n\n  /**\n   * Handle activation\n   */\n  handleActivation(event) {\n    const element = document.activeElement;\n    if (element && element.click) {\n      element.click();\n    }\n  }\n\n  /**\n   * Handle escape key\n   */\n  handleEscape(event) {\n    // Emit escape event for game to handle\n    this.eventBus.emit('input:escape', {\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Handle arrow navigation\n   */\n  handleArrowNavigation(event) {\n    // Emit arrow navigation event\n    this.eventBus.emit('input:arrowNavigation', {\n      direction: event.key.replace('Arrow', '').toLowerCase(),\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Update gamepad state\n   */\n  updateGamepadState() {\n    if (!this.settings.enableGamepad) return;\n\n    const gamepads = navigator.getGamepads();\n\n    for (let i = 0; i < gamepads.length; i++) {\n      const gamepad = gamepads[i];\n      if (!gamepad) continue;\n\n      const controller = this.gamepad.controllers.get(i);\n      if (!controller) continue;\n\n      // Update button states\n      for (let j = 0; j < gamepad.buttons.length; j++) {\n        const button = gamepad.buttons[j];\n        const wasPressed = controller.buttons.get(j)?.pressed || false;\n        const isPressed = button.pressed;\n\n        if (isPressed !== wasPressed) {\n          controller.buttons.set(j, {\n            pressed: isPressed,\n            value: button.value,\n            timestamp: Date.now(),\n          });\n\n          // Emit button event\n          this.eventBus.emit('input:gamepadButton', {\n            controller: i,\n            button: j,\n            pressed: isPressed,\n            value: button.value,\n            timestamp: Date.now(),\n          });\n        }\n      }\n\n      // Update axis states\n      for (let j = 0; j < gamepad.axes.length; j++) {\n        const axis = gamepad.axes[j];\n        const previousAxis = controller.axes.get(j) || 0;\n\n        // Apply deadzone\n        const deadzone = this.settings.deadzone;\n        const adjustedAxis = Math.abs(axis) < deadzone ? 0 : axis;\n\n        if (Math.abs(adjustedAxis - previousAxis) > 0.01) {\n          controller.axes.set(j, adjustedAxis);\n\n          // Emit axis event\n          this.eventBus.emit('input:gamepadAxis', {\n            controller: i,\n            axis: j,\n            value: adjustedAxis,\n            timestamp: Date.now(),\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * Update accessibility features\n   */\n  updateAccessibilityFeatures() {\n    // Update focusable elements if DOM has changed\n    this.updateFocusableElements();\n    this.updateTabOrder();\n  }\n\n  /**\n   * Process input events\n   */\n  processInputEvents() {\n    // Process any queued input events\n    // This could include input buffering, input prediction, etc.\n  }\n\n  /**\n   * Handle mapped actions\n   */\n  handleMappedAction(inputType, input, action, event) {\n    let mapping;\n\n    switch (inputType) {\n      case 'keyboard':\n        mapping = this.keyMappings;\n        break;\n      case 'mouse':\n        mapping = this.mouseMappings;\n        break;\n      case 'gamepad':\n        mapping = this.gamepadMappings;\n        break;\n      case 'touch':\n        mapping = this.touchMappings;\n        break;\n      default:\n        return;\n    }\n\n    // Find mapped action\n    for (const [actionName, inputs] of mapping) {\n      if (inputs.includes(input)) {\n        this.eventBus.emit('input:action', {\n          action: actionName,\n          inputType,\n          input,\n          state: action,\n          event,\n          timestamp: Date.now(),\n        });\n      }\n    }\n  }\n\n  /**\n   * Get key name from key code\n   */\n  getKeyName(keyCode) {\n    const keyNames = {\n      KeyA: 'A',\n      KeyB: 'B',\n      KeyC: 'C',\n      KeyD: 'D',\n      KeyE: 'E',\n      KeyF: 'F',\n      KeyG: 'G',\n      KeyH: 'H',\n      KeyI: 'I',\n      KeyJ: 'J',\n      KeyK: 'K',\n      KeyL: 'L',\n      KeyM: 'M',\n      KeyN: 'N',\n      KeyO: 'O',\n      KeyP: 'P',\n      KeyQ: 'Q',\n      KeyR: 'R',\n      KeyS: 'S',\n      KeyT: 'T',\n      KeyU: 'U',\n      KeyV: 'V',\n      KeyW: 'W',\n      KeyX: 'X',\n      KeyY: 'Y',\n      KeyZ: 'Z',\n      Digit0: '0',\n      Digit1: '1',\n      Digit2: '2',\n      Digit3: '3',\n      Digit4: '4',\n      Digit5: '5',\n      Digit6: '6',\n      Digit7: '7',\n      Digit8: '8',\n      Digit9: '9',\n      Space: 'Space',\n      Enter: 'Enter',\n      Escape: 'Escape',\n      Backspace: 'Backspace',\n      Tab: 'Tab',\n      ShiftLeft: 'Left Shift',\n      ShiftRight: 'Right Shift',\n      ControlLeft: 'Left Ctrl',\n      ControlRight: 'Right Ctrl',\n      AltLeft: 'Left Alt',\n      AltRight: 'Right Alt',\n      ArrowUp: 'Up Arrow',\n      ArrowDown: 'Down Arrow',\n      ArrowLeft: 'Left Arrow',\n      ArrowRight: 'Right Arrow',\n    };\n\n    return keyNames[keyCode] || keyCode;\n  }\n\n  /**\n   * Get mouse button name\n   */\n  getMouseButtonName(button) {\n    const buttonNames = {\n      0: 'Left',\n      1: 'Middle',\n      2: 'Right',\n      3: 'Back',\n      4: 'Forward',\n    };\n\n    return buttonNames[button] || `Button ${button}`;\n  }\n\n  /**\n   * Load settings from config\n   */\n  loadSettingsFromConfig() {\n    if (!this.config) return;\n\n    this.settings = {\n      ...this.settings,\n      mouseSensitivity:\n        this.config.getConfigValue('input.mouseSensitivity') ||\n        this.settings.mouseSensitivity,\n      keyboardLayout:\n        this.config.getConfigValue('input.keyboardLayout') ||\n        this.settings.keyboardLayout,\n      enableMouseLook:\n        this.config.getConfigValue('input.enableMouseLook') ??\n        this.settings.enableMouseLook,\n      enableKeyboardNavigation:\n        this.config.getConfigValue('input.enableKeyboardNavigation') ??\n        this.settings.enableKeyboardNavigation,\n      enableGamepad:\n        this.config.getConfigValue('input.enableGamepad') ??\n        this.settings.enableGamepad,\n      enableTouch:\n        this.config.getConfigValue('input.enableTouch') ??\n        this.settings.enableTouch,\n      invertY:\n        this.config.getConfigValue('input.invertY') ?? this.settings.invertY,\n      deadzone:\n        this.config.getConfigValue('input.deadzone') || this.settings.deadzone,\n    };\n  }\n\n  /**\n   * Enable input\n   */\n  enable() {\n    this.isEnabled = true;\n    this.logger.info('Input enabled');\n  }\n\n  /**\n   * Disable input\n   */\n  disable() {\n    this.isEnabled = false;\n    this.logger.info('Input disabled');\n  }\n\n  /**\n   * Capture input\n   */\n  capture() {\n    this.isCaptured = true;\n    document.body.style.cursor = 'none';\n    this.logger.info('Input captured');\n  }\n\n  /**\n   * Release input\n   */\n  release() {\n    this.isCaptured = false;\n    document.body.style.cursor = 'default';\n    this.logger.info('Input released');\n  }\n\n  /**\n   * Get input state\n   */\n  getInputState() {\n    return {\n      keyboard: Object.fromEntries(this.keys),\n      mouse: this.mouse,\n      touch: Object.fromEntries(this.touch.touches),\n      gamepad: Object.fromEntries(this.gamepad.controllers),\n      accessibility: this.accessibility,\n    };\n  }\n\n  /**\n   * Set key mapping\n   */\n  setKeyMapping(action, keys) {\n    this.keyMappings.set(action, keys);\n  }\n\n  /**\n   * Get key mapping\n   */\n  getKeyMapping(action) {\n    return this.keyMappings.get(action) || [];\n  }\n\n  /**\n   * Check if key is pressed\n   */\n  isKeyPressed(key) {\n    const keyState = this.keys.get(key);\n    return keyState ? keyState.pressed : false;\n  }\n\n  /**\n   * Check if mouse button is pressed\n   */\n  isMouseButtonPressed(button) {\n    const buttonState = this.mouse.buttons.get(button);\n    return buttonState ? buttonState.pressed : false;\n  }\n\n  /**\n   * Get mouse position\n   */\n  getMousePosition() {\n    return { x: this.mouse.x, y: this.mouse.y };\n  }\n\n  /**\n   * Get gamepad state\n   */\n  getGamepadState(index) {\n    return this.gamepad.controllers.get(index);\n  }\n\n  /**\n   * Get all gamepads\n   */\n  getAllGamepads() {\n    return Array.from(this.gamepad.controllers.values());\n  }\n\n  /**\n   * Handle mobile touch start\n   */\n  handleMobileTouchStart(touch, event) {\n    // Check if touch is on virtual joystick\n    if (this.isTouchOnVirtualJoystick(touch)) {\n      this.activateVirtualJoystick(touch);\n      return;\n    }\n\n    // Check if touch is on action buttons\n    const button = this.getTouchedButton(touch);\n    if (button) {\n      this.handleMobileButtonPress(button.id, button.key, 'down');\n      return;\n    }\n\n    // Handle gesture recognition\n    this.handleGestureStart(touch, event);\n  }\n\n  /**\n   * Handle mobile touch move\n   */\n  handleMobileTouchMove(touch, event) {\n    // Update virtual joystick if active\n    if (this.mobileUI.virtualJoystick.active && \n        this.mobileUI.virtualJoystick.touchId === touch.identifier) {\n      this.updateVirtualJoystick(touch);\n    }\n\n    // Handle gesture recognition\n    this.handleGestureMove(touch, event);\n  }\n\n  /**\n   * Handle mobile touch end\n   */\n  handleMobileTouchEnd(touch, event) {\n    // Deactivate virtual joystick if it was active\n    if (this.mobileUI.virtualJoystick.active && \n        this.mobileUI.virtualJoystick.touchId === touch.identifier) {\n      this.deactivateVirtualJoystick();\n    }\n\n    // Handle gesture recognition\n    this.handleGestureEnd(touch, event);\n  }\n\n  /**\n   * Check if touch is on virtual joystick\n   */\n  isTouchOnVirtualJoystick(touch) {\n    if (!this.mobileUI.virtualJoystick.element) return false;\n\n    const rect = this.mobileUI.virtualJoystick.element.getBoundingClientRect();\n    return touch.clientX >= rect.left && \n           touch.clientX <= rect.right && \n           touch.clientY >= rect.top && \n           touch.clientY <= rect.bottom;\n  }\n\n  /**\n   * Activate virtual joystick\n   */\n  activateVirtualJoystick(touch) {\n    this.mobileUI.virtualJoystick.active = true;\n    this.mobileUI.virtualJoystick.touchId = touch.identifier;\n    \n    const rect = this.mobileUI.virtualJoystick.element.getBoundingClientRect();\n    this.mobileUI.virtualJoystick.center = {\n      x: rect.left + rect.width / 2,\n      y: rect.top + rect.height / 2,\n    };\n\n    this.logger.info('Virtual joystick activated');\n  }\n\n  /**\n   * Update virtual joystick\n   */\n  updateVirtualJoystick(touch) {\n    if (!this.mobileUI.virtualJoystick.active) return;\n\n    const center = this.mobileUI.virtualJoystick.center;\n    const deltaX = touch.clientX - center.x;\n    const deltaY = touch.clientY - center.y;\n    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n    const maxDistance = this.settings.mobileUI.joystickSize / 2;\n\n    // Clamp to joystick radius\n    const clampedDistance = Math.min(distance, maxDistance);\n    const angle = Math.atan2(deltaY, deltaX);\n\n    const knobX = Math.cos(angle) * clampedDistance;\n    const knobY = Math.sin(angle) * clampedDistance;\n\n    // Update knob position\n    if (this.mobileUI.virtualJoystick.knob) {\n      this.mobileUI.virtualJoystick.knob.style.transform = \n        `translate(calc(-50% + ${knobX}px), calc(-50% + ${knobY}px))`;\n    }\n\n    // Calculate normalized values\n    const normalizedX = deltaX / maxDistance;\n    const normalizedY = deltaY / maxDistance;\n\n    // Apply deadzone\n    const deadzone = this.settings.mobileUI.joystickDeadzone;\n    const finalX = Math.abs(normalizedX) < deadzone ? 0 : normalizedX;\n    const finalY = Math.abs(normalizedY) < deadzone ? 0 : normalizedY;\n\n    // Emit joystick movement event\n    this.eventBus.emit('input:joystickMove', {\n      x: finalX,\n      y: finalY,\n      angle: angle * 180 / Math.PI,\n      distance: clampedDistance / maxDistance,\n      timestamp: Date.now(),\n    });\n\n    // Map to keyboard events for compatibility\n    this.mapJoystickToKeyboard(finalX, finalY);\n  }\n\n  /**\n   * Deactivate virtual joystick\n   */\n  deactivateVirtualJoystick() {\n    this.mobileUI.virtualJoystick.active = false;\n    this.mobileUI.virtualJoystick.touchId = null;\n\n    // Reset knob position\n    if (this.mobileUI.virtualJoystick.knob) {\n      this.mobileUI.virtualJoystick.knob.style.transform = 'translate(-50%, -50%)';\n    }\n\n    // Emit joystick release event\n    this.eventBus.emit('input:joystickRelease', {\n      timestamp: Date.now(),\n    });\n\n    this.logger.info('Virtual joystick deactivated');\n  }\n\n  /**\n   * Map joystick movement to keyboard events\n   */\n  mapJoystickToKeyboard(x, y) {\n    const threshold = 0.3;\n\n    // Horizontal movement\n    if (x > threshold) {\n      this.handleMappedAction('keyboard', 'KeyD', 'down', { synthetic: true });\n    } else if (x < -threshold) {\n      this.handleMappedAction('keyboard', 'KeyA', 'down', { synthetic: true });\n    }\n\n    // Vertical movement\n    if (y > threshold) {\n      this.handleMappedAction('keyboard', 'KeyS', 'down', { synthetic: true });\n    } else if (y < -threshold) {\n      this.handleMappedAction('keyboard', 'KeyW', 'down', { synthetic: true });\n    }\n  }\n\n  /**\n   * Get touched button\n   */\n  getTouchedButton(touch) {\n    for (const [id, button] of this.mobileUI.actionButtons) {\n      const rect = button.getBoundingClientRect();\n      if (touch.clientX >= rect.left && \n          touch.clientX <= rect.right && \n          touch.clientY >= rect.top && \n          touch.clientY <= rect.bottom) {\n        return { id, key: this.getButtonKey(id) };\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get button key mapping\n   */\n  getButtonKey(buttonId) {\n    const keyMap = {\n      jump: 'Space',\n      interact: 'KeyE',\n      crouch: 'KeyC',\n      run: 'ShiftLeft',\n      menu: 'KeyM',\n      pause: 'Escape',\n    };\n    return keyMap[buttonId] || null;\n  }\n\n  /**\n   * Handle mobile button press\n   */\n  handleMobileButtonPress(buttonId, key, action) {\n    // Emit haptic feedback if enabled\n    if (this.settings.mobileControls.hapticFeedback && navigator.vibrate) {\n      navigator.vibrate(50);\n    }\n\n    // Emit input event\n    this.eventBus.emit('input:mobileButton', {\n      buttonId,\n      key,\n      action,\n      timestamp: Date.now(),\n    });\n\n    // Map to keyboard event for compatibility\n    if (key) {\n      this.handleMappedAction('keyboard', key, action, { synthetic: true });\n    }\n\n    this.logger.info(`Mobile button ${action}: ${buttonId}`);\n  }\n\n  /**\n   * Handle gesture start\n   */\n  handleGestureStart(touch, event) {\n    const currentTime = Date.now();\n    \n    // Check for double tap\n    if (this.settings.gestures.enableDoubleTap) {\n      const timeDiff = currentTime - this.touch.lastTapTime;\n      const distance = this.getDistance(touch, this.touch.lastTapPosition);\n      \n      if (timeDiff < this.settings.mobileControls.doubleTapDelay && distance < 50) {\n        this.handleDoubleTap(touch);\n        return;\n      }\n    }\n\n    // Set up long press timer\n    if (this.settings.gestures.enableLongPress) {\n      this.touch.longPressTimer = setTimeout(() => {\n        this.handleLongPress(touch);\n      }, this.settings.mobileControls.longPressDelay);\n    }\n\n    // Update last tap info\n    this.touch.lastTapTime = currentTime;\n    this.touch.lastTapPosition = { x: touch.clientX, y: touch.clientY };\n  }\n\n  /**\n   * Handle gesture move\n   */\n  handleGestureMove(touch, event) {\n    // Clear long press timer if moving\n    if (this.touch.longPressTimer) {\n      clearTimeout(this.touch.longPressTimer);\n      this.touch.longPressTimer = null;\n    }\n  }\n\n  /**\n   * Handle gesture end\n   */\n  handleGestureEnd(touch, event) {\n    // Clear long press timer\n    if (this.touch.longPressTimer) {\n      clearTimeout(this.touch.longPressTimer);\n      this.touch.longPressTimer = null;\n    }\n\n    // Check for swipe\n    if (this.settings.gestures.enableSwipe) {\n      this.checkForSwipe(touch, touch);\n    }\n  }\n\n  /**\n   * Check for swipe gesture\n   */\n  checkForSwipe(startTouch, endTouch) {\n    const deltaX = endTouch.clientX - startTouch.startX;\n    const deltaY = endTouch.clientY - startTouch.startY;\n    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n    \n    if (distance < this.settings.mobileControls.swipeThreshold) {\n      return; // Not a swipe\n    }\n\n    const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;\n    let direction = '';\n\n    if (angle > -45 && angle <= 45) {\n      direction = 'right';\n    } else if (angle > 45 && angle <= 135) {\n      direction = 'down';\n    } else if (angle > 135 || angle <= -135) {\n      direction = 'left';\n    } else if (angle > -135 && angle <= -45) {\n      direction = 'up';\n    }\n\n    if (this.settings.gestures.swipeDirections.includes(direction)) {\n      this.handleSwipeGesture(direction, distance);\n    }\n  }\n\n  /**\n   * Handle swipe gesture\n   */\n  handleSwipeGesture(direction, distance) {\n    this.eventBus.emit('input:swipe', {\n      direction,\n      distance,\n      timestamp: Date.now(),\n    });\n\n    this.logger.info(`Swipe detected: ${direction}`);\n  }\n\n  /**\n   * Handle pinch gesture\n   */\n  handlePinchGesture(scale) {\n    this.eventBus.emit('input:pinch', {\n      scale,\n      timestamp: Date.now(),\n    });\n\n    this.logger.info(`Pinch detected: ${scale.toFixed(2)}`);\n  }\n\n  /**\n   * Handle rotate gesture\n   */\n  handleRotateGesture(rotation) {\n    this.eventBus.emit('input:rotate', {\n      rotation,\n      timestamp: Date.now(),\n    });\n\n    this.logger.info(`Rotate detected: ${rotation.toFixed(2)}°`);\n  }\n\n  /**\n   * Handle double tap\n   */\n  handleDoubleTap(touch) {\n    this.eventBus.emit('input:doubleTap', {\n      x: touch.clientX,\n      y: touch.clientY,\n      timestamp: Date.now(),\n    });\n\n    this.logger.info('Double tap detected');\n  }\n\n  /**\n   * Handle long press\n   */\n  handleLongPress(touch) {\n    this.eventBus.emit('input:longPress', {\n      x: touch.clientX,\n      y: touch.clientY,\n      timestamp: Date.now(),\n    });\n\n    this.logger.info('Long press detected');\n  }\n\n  /**\n   * Get distance between two touch points\n   */\n  getDistance(touch1, touch2) {\n    const dx = touch1.clientX - touch2.clientX;\n    const dy = touch1.clientY - touch2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  /**\n   * Get angle between two touch points\n   */\n  getAngle(touch1, touch2) {\n    return Math.atan2(touch2.clientY - touch1.clientY, touch2.clientX - touch1.clientX);\n  }\n\n  /**\n   * Update mobile controls visibility\n   */\n  updateMobileControlsVisibility(visible) {\n    this.mobileUI.isVisible = visible;\n    \n    if (this.mobileControlsContainer) {\n      this.mobileControlsContainer.style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Update mobile controls settings\n   */\n  updateMobileSettings(newSettings) {\n    this.settings.mobileControls = { ...this.settings.mobileControls, ...newSettings };\n    this.settings.gestures = { ...this.settings.gestures, ...newSettings.gestures };\n    this.settings.mobileUI = { ...this.settings.mobileUI, ...newSettings.mobileUI };\n\n    // Recreate mobile UI if needed\n    if (this.mobileControlsContainer) {\n      this.mobileControlsContainer.remove();\n      this.createMobileUI();\n    }\n\n    this.logger.info('Mobile settings updated');\n  }\n\n  /**\n   * Get mobile controls state\n   */\n  getMobileControlsState() {\n    return {\n      isMobile: this.isMobile,\n      isVisible: this.mobileUI.isVisible,\n      orientation: this.mobileUI.orientation,\n      virtualJoystick: {\n        active: this.mobileUI.virtualJoystick.active,\n        position: this.mobileUI.virtualJoystick.position,\n      },\n      settings: {\n        mobileControls: this.settings.mobileControls,\n        gestures: this.settings.gestures,\n        mobileUI: this.settings.mobileUI,\n      },\n    };\n  }\n}\n\nexport default InputManager;\n"],"names":["exports","constructor","this","listeners","Map","eventHistory","maxHistorySize","debug","performanceMetrics","totalEvents","averageProcessingTime","slowestEvent","eventCounts","on","event","callback","options","Error","has","set","listener","once","priority","id","context","get","push","sort","a","b","log","off","eventListeners","index","findIndex","splice","removeAllListeners","delete","clear","removeListener","emit","data","startTime","performance","now","eventData","timestamp","Date","generateEventId","addToHistory","updatePerformanceMetrics","listenersToRemove","i","length","call","error","emitAsync","Promise","resolve","reject","waitFor","timeout","timeoutId","setTimeout","handler","clearTimeout","shift","processingTime","totalTime","time","count","Math","random","toString","substr","getHistory","filter","history","item","since","until","limit","slice","getPerformanceMetrics","Object","fromEntries","clearHistory","resetMetrics","enableDebug","disableDebug","message","getListenerCount","getRegisteredEvents","Array","from","keys","hasListeners","createFilter","condition","createTransformer","transform","transformedData","destroy","dependencies","eventBus","logger","config","enableFPSMonitoring","enableMemoryMonitoring","enableAudioMonitoring","enableRenderingMonitoring","enableInputMonitoring","enableNetworkMonitoring","enableAutoOptimization","fpsTarget","fpsWarningThreshold","fpsCriticalThreshold","memoryWarningThreshold","memoryCriticalThreshold","frameTimeWarningThreshold","frameTimeCriticalThreshold","reportInterval","metrics","fps","current","average","min","Infinity","max","droppedFrames","frameTime","memory","used","total","available","leakDetected","leakCount","audio","contextState","contextRecreations","bufferUnderruns","latency","performanceScore","rendering","drawCalls","triangles","textures","shaders","batchCount","cullingTime","lightingTime","postProcessingTime","input","lag","eventCount","droppedEvents","averageResponseTime","network","bandwidth","packetLoss","connectionQuality","isMonitoring","lastFrameTime","frameCount","lastReportTime","optimizationSuggestions","performanceAlerts","observers","setupPerformanceMonitoring","setupEventHandlers","info","initialize","startMonitoring","cleanup","stopMonitoring","disconnectObservers","setupFPSMonitoring","setupMemoryMonitoring","setupAudioMonitoring","setupRenderingMonitoring","setupInputMonitoring","setupNetworkMonitoring","handleGameStarted","bind","handleGamePaused","handleGameResumed","handleGameStopped","handleFrame","handleMemoryUpdate","handleAudioUpdate","handleRenderingUpdate","handleInputUpdate","handleNetworkUpdate","measureFPS","currentTime","deltaTime","updateFPSMetrics","requestAnimationFrame","warn","measureMemory","updateMemoryMetrics","detectMemoryLeaks","measureAudio","checkAudioContextHealth","measureRendering","updateRenderingMetrics","lastInputTime","measureInput","responseTime","updateInputMetrics","document","addEventListener","measureNetwork","updateNetworkMetrics","removeEventListener","reduce","checkFPSPerformance","usedJSHeapSize","totalJSHeapSize","jsHeapSizeLimit","checkMemoryPerformance","updateAudioMetrics","audioData","checkAudioPerformance","checkInputPerformance","addPerformanceAlert","threshold","suggestOptimization","recreations","underruns","recent","every","entry","level","alert","category","suggestion","optimization","getPerformanceReport","alerts","suggestions","getPerformanceScore","score","memoryUsage","updateConfig","newConfig","getMetrics","getAlerts","getOptimizationSuggestions","clearAlerts","clearOptimizationSuggestions","mouse","x","y","buttons","wheel","touch","touches","gestures","activeGestures","lastTapTime","lastTapPosition","longPressTimer","doubleTapTimer","mobileUI","virtualJoystick","active","center","position","radius","touchId","actionButtons","isVisible","orientation","gamepad","controllers","lastUpdate","keyMappings","mouseMappings","gamepadMappings","touchMappings","accessibility","keyboardNavigation","focusManagement","tabOrder","currentFocusIndex","focusableElements","Set","skipLinks","settings","mouseSensitivity","keyboardLayout","enableMouseLook","enableKeyboardNavigation","enableGamepad","enableTouch","invertY","deadzone","repeatDelay","repeatRate","mobileControls","enabled","layout","size","opacity","showLabels","hapticFeedback","gestureSensitivity","touchDeadzone","multiTouch","pinchToZoom","swipeThreshold","longPressDelay","doubleTapDelay","enableSwipe","enablePinch","enableRotate","enableLongPress","enableDoubleTap","swipeDirections","pinchThreshold","rotateThreshold","showVirtualJoystick","showActionButtons","showMenuButton","showPauseButton","buttonSpacing","buttonSize","joystickSize","joystickDeadzone","buttonOpacity","buttonPressScale","enableButtonHaptics","boundHandlers","isEnabled","isCaptured","initializeInputMappings","setupAccessibility","setupMobileControls","loadSettingsFromConfig","setupFocusManagement","removeEventHandlers","update","updateGamepadState","updateAccessibilityFeatures","processInputEvents","handleKeyDown","handleKeyUp","handleKeyPress","handleMouseDown","handleMouseUp","handleMouseMove","handleWheel","handleContextMenu","handleTouchStart","handleTouchEnd","handleTouchMove","handleTouchCancel","handleGamepadConnected","handleGamepadDisconnected","handleFocusIn","handleFocusOut","addEventListeners","passive","updateFocusableElements","updateTabOrder","setupSkipLinks","querySelectorAll","join","forEach","element","add","parseInt","getAttribute","text","target","link","window","navigator","userAgent","includes","detectMobileDevice","createMobileUI","setupOrientationHandling","setupGestureRecognition","isMobile","test","isTouch","maxTouchPoints","mobileControlsContainer","createElement","className","style","cssText","nodeType","createVirtualJoystick","createActionButtons","createMenuButton","createPauseButton","body","appendChild","joystickContainer","joystickBase","joystickKnob","base","knob","buttonContainer","label","key","button","buttonElement","textContent","e","preventDefault","handleMobileButtonPress","menuButton","innerHTML","pauseButton","updateOrientation","isPortrait","innerHeight","innerWidth","adjustMobileControlsForOrientation","height","setupBasicGestureDetection","startTouches","startDistance","startAngle","getDistance","getAngle","scale","abs","handlePinchGesture","rotation","handleRotateGesture","checkForSwipe","changedTouches","code","keyName","getKeyName","pressed","repeat","handleAccessibilityKeyDown","keyCode","ctrlKey","shiftKey","altKey","metaKey","handleMappedAction","charCode","buttonName","getMouseButtonName","clientX","clientY","deltaX","deltaY","sensitivity","adjustedDeltaX","adjustedDeltaY","direction","identifier","startX","startY","pressure","force","handleMobileTouchStart","map","handleMobileTouchEnd","touchData","handleMobileTouchMove","connected","axes","indexOf","handleTabNavigation","handleActivation","handleEscape","handleArrowNavigation","newIndex","nextElement","focus","activeElement","click","replace","toLowerCase","gamepads","getGamepads","controller","j","wasPressed","isPressed","value","axis","previousAxis","adjustedAxis","inputType","action","mapping","actionName","inputs","state","KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Space","Enter","Escape","Backspace","Tab","ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","getConfigValue","enable","disable","capture","cursor","release","getInputState","keyboard","setKeyMapping","getKeyMapping","isKeyPressed","keyState","isMouseButtonPressed","buttonState","getMousePosition","getGamepadState","getAllGamepads","values","isTouchOnVirtualJoystick","activateVirtualJoystick","getTouchedButton","handleGestureStart","updateVirtualJoystick","handleGestureMove","deactivateVirtualJoystick","handleGestureEnd","rect","getBoundingClientRect","left","right","top","bottom","width","distance","sqrt","maxDistance","clampedDistance","angle","atan2","knobX","cos","knobY","sin","normalizedX","normalizedY","finalX","finalY","PI","mapJoystickToKeyboard","synthetic","getButtonKey","buttonId","jump","interact","crouch","run","menu","pause","vibrate","timeDiff","handleDoubleTap","handleLongPress","startTouch","endTouch","handleSwipeGesture","toFixed","touch1","touch2","dx","dy","updateMobileControlsVisibility","visible","display","updateMobileSettings","newSettings","remove","getMobileControlsState"],"mappings":"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"}